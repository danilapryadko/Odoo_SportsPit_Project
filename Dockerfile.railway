# Максимально простой Odoo 18
FROM odoo:18.0

# Создаем скрипт запуска с задержкой
USER root
RUN echo '#!/bin/bash\n\
echo "Starting Odoo 18..."\n\
echo "Waiting for database..."\n\
sleep 10\n\
echo "Starting Odoo server..."\n\
exec odoo \
--db_host=$PGHOST \
--db_port=$PGPORT \
--db_user=$PGUSER \
--db_password=$PGPASSWORD \
--db_name=$PGDATABASE \
--http-port=${PORT:-8069} \
--without-demo=all' > /entrypoint.sh && chmod +x /entrypoint.sh

USER odoo
EXPOSE 8069

ENTRYPOINT ["/entrypoint.sh"]