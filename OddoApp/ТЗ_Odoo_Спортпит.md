# Техническое задание на развертывание Odoo для производства спортивного питания

## 1. Общая информация

### 1.1 Цель проекта
Развернуть и настроить систему Odoo Community Edition для управления производством спортивного питания с интеграцией российских систем маркировки (Меркурий, Честный ЗНАК).

### 1.2 Платформа развертывания
- **Хостинг:** Railway.com (тариф Pro)
- **GitHub репозиторий:** https://github.com/danilapryadko/Odoo_SportsPit_Project.git
- **Метод деплоя:** GitHub repository → Railway автоматический деплой
- **База данных:** PostgreSQL (через Railway)
- **Версия Odoo:** 17.0 Community Edition
- **Язык по умолчанию:** Русский (ru_RU)
- **Часовой пояс:** Europe/Moscow (UTC+3)

## 2. Требуемые модули Odoo

### 2.1 Основные модули (обязательные)
- [ ] **Manufacturing (MRP)** - управление производством и рецептурами
- [ ] **Inventory** - складской учет с партионным учетом
- [ ] **Purchase** - управление закупками
- [ ] **Sales** - управление продажами
- [ ] **Quality Control** - контроль качества
- [ ] **Accounting** - базовая бухгалтерия
- [ ] **Employees (HR)** - управление персоналом
- [ ] **Attendances** - учет рабочего времени
- [ ] **Project** - управление задачами и производственными заданиями
- [ ] **Timesheet** - учет времени по задачам

### 2.2 Дополнительные модули
- [ ] **Product Expiry** - управление сроками годности
- [ ] **Batch/Lot Tracking** - партионный учет
- [ ] **Maintenance** - обслуживание оборудования
- [ ] **CRM** - управление клиентами (опционально)

## 3. Структура GitHub репозитория

```
odoo-sports-nutrition/
├── Dockerfile
├── railway.json
├── odoo.conf
├── requirements.txt
├── README.md
├── .env.example
├── addons/
│   ├── sports_nutrition_base/      # Базовый модуль для спортпита
│   ├── mercury_integration/        # Интеграция с Меркурий
│   ├── chestny_znak_integration/   # Интеграция с Честный ЗНАК
│   └── production_automation/      # Автоматизация производства
└── docs/
    ├── installation.md
    └── configuration.md
```

## 4. Настройка Docker и Railway

### 4.1 Dockerfile
```dockerfile
FROM odoo:17.0

USER root

# Установка русской локали и московского времени
RUN apt-get update && apt-get install -y \
    locales \
    tzdata \
    && sed -i '/ru_RU.UTF-8/s/^# //g' /etc/locale.gen \
    && locale-gen ru_RU.UTF-8 \
    && ln -sf /usr/share/zoneinfo/Europe/Moscow /etc/localtime \
    && echo "Europe/Moscow" > /etc/timezone \
    && dpkg-reconfigure -f noninteractive tzdata

ENV LANG ru_RU.UTF-8
ENV LANGUAGE ru_RU:ru
ENV LC_ALL ru_RU.UTF-8
ENV TZ Europe/Moscow

# Установка системных зависимостей
# Установка Python библиотек из requirements.txt
# Копирование кастомных модулей
# Настройка прав доступа

USER odoo
```

### 4.2 requirements.txt - необходимые библиотеки
- xlrd==1.2.0 (работа с Excel)
- xlwt==1.3.0
- openpyxl==3.0.10
- pandas (аналитика)
- python-barcode (штрихкоды)
- qrcode (QR-коды для маркировки)
- requests (API интеграции)
- xmltodict (работа с XML для Меркурий)
- zeep (SOAP для интеграций)

### 4.3 Переменные окружения Railway
- База данных PostgreSQL (автоматические переменные)
- ADMIN_PASSWORD (безопасный пароль администратора)
- DB_NAME=odoo_sportpit
- LANG=ru_RU.UTF-8 (русский язык по умолчанию)
- TZ=Europe/Moscow (московское время)
- Настройки производительности (workers, memory limits)

## 5. Кастомные модули для разработки

### 5.0 Настройка русского языка и часового пояса в Odoo
**Автоматическая установка при первом запуске:**
- Установить модуль `base` с русской локализацией
- Загрузить русский перевод через Settings → Translations → Load Translation
- Установить русский язык по умолчанию для всех пользователей
- Настроить русские форматы дат, чисел и валюты (рубли)
- Установить часовой пояс Europe/Moscow для всех пользователей

**odoo.conf дополнения:**
```ini
lang = ru_RU
default_lang = ru_RU
timezone = Europe/Moscow
```

**Настройка в базе данных при инициализации:**
```sql
UPDATE res_users SET tz='Europe/Moscow' WHERE tz IS NULL;
UPDATE res_company SET tz='Europe/Moscow';
```

### 5.1 sports_nutrition_base
**Функциональность:**
- Расширенные поля для продуктов (БЖУ, калории, состав)
- Категории: протеины, гейнеры, BCAA, витамины
- Калькулятор пищевой ценности
- Шаблоны этикеток

### 5.2 mercury_integration
**Функциональность:**
- Синхронизация с системой Меркурий
- Автоматическое создание ВСД
- Получение входящих ВСД
- Гашение ВСД при производстве
- Отчеты для Россельхознадзора

**API endpoints:**
- Подключение к API Меркурий
- Авторизация с сертификатом
- Обработка XML документов

### 5.3 chestny_znak_integration
**Функциональность:**
- Получение кодов маркировки
- Печать DataMatrix кодов
- Ввод в оборот
- Вывод из оборота
- Отчет об использовании кодов

**API endpoints:**
- Интеграция с API Честного ЗНАКа
- Работа с токенами авторизации
- Обработка batch-запросов

### 5.4 production_automation
**Функциональность:**
- Автоматическое создание задач при запуске производства
- Распределение задач по участкам:
  - Склад сырья
  - Взвешивание
  - Смешивание
  - Лаборатория
  - Фасовка
  - Маркировка
  - Упаковка
- Уведомления о готовности этапов
- Контрольные точки качества

## 6. Автоматизация производственных процессов

### 6.1 Workflow производственного заказа
```
1. Создание Manufacturing Order
   ↓
2. Автоматическое создание задач:
   - Задача складу: подготовить сырье
   - Задача лаборатории: входной контроль
   - Задача производству: смешивание
   - Задача на фасовку
   - Задача на маркировку (Честный ЗНАК)
   - Задача на регистрацию (Меркурий)
   ↓
3. Отслеживание выполнения через канбан-доску
   ↓
4. Автоматическое закрытие при выполнении всех задач
```

### 6.2 Интеграция с графиком сотрудников
- Назначение задач на смены
- Учет загрузки персонала
- Расчет KPI по выполненным задачам

## 7. Настройка для специфики спортпита

### 7.1 Контроль качества
- Входной контроль сырья (сертификаты)
- Контроль процесса смешивания
- Лабораторный анализ (белок, микробиология)
- Контроль веса при фасовке
- Финальная проверка маркировки

### 7.2 Управление рецептурами
- Многоуровневые спецификации
- Версионность рецептур
- Расчет пищевой ценности
- Контроль аллергенов

### 7.3 Работа со сроками годности
- FEFO (First Expired, First Out)
- Автоматические предупреждения
- Блокировка просроченного сырья
- Планирование производства с учетом сроков

## 8. Этапы реализации

### Этап 1: Базовая настройка (1 неделя)
- [ ] Форкнуть/клонировать репозиторий https://github.com/danilapryadko/Odoo_SportsPit_Project.git
- [ ] Настроить Dockerfile с русской локализацией
- [ ] Настроить requirements.txt
- [ ] Развернуть на Railway
- [ ] Установить базовые модули Odoo
- [ ] Установить русский язык по умолчанию в настройках Odoo
- [ ] Создать структуру папок для кастомных модулей

### Этап 2: Кастомизация (2-3 недели)
- [ ] Разработать модуль sports_nutrition_base
- [ ] Настроить производственные процессы
- [ ] Создать шаблоны документов
- [ ] Настроить контрольные точки качества

### Этап 3: Интеграции (3-4 недели)
- [ ] Разработать модуль mercury_integration
- [ ] Разработать модуль chestny_znak_integration
- [ ] Настроить API подключения
- [ ] Тестирование интеграций

### Этап 4: Автоматизация (1-2 недели)
- [ ] Настроить автоматическое создание задач
- [ ] Настроить уведомления
- [ ] Создать отчеты и дашборды
- [ ] Настроить права доступа

### Этап 5: Тестирование и запуск (1 неделя)
- [ ] Полное тестирование процессов
- [ ] Обучение пользователей
- [ ] Миграция данных
- [ ] Запуск в продуктив

## 9. Требования к разработчику

### Необходимые навыки:
- Python (для разработки модулей Odoo)
- PostgreSQL
- Docker
- Git/GitHub
- Опыт работы с Odoo (желательно v15+)
- Понимание REST API
- Опыт работы с XML (для Меркурий)

### Желательные навыки:
- Опыт интеграции с российскими системами маркировки
- Знание производственных процессов
- Опыт работы с Railway или аналогичными PaaS

## 10. Бюджет и сроки

### Сроки:
- Общий срок: 8-10 недель
- MVP (без интеграций): 3-4 недели
- Полная версия: 8-10 недель

### Инфраструктура (ежемесячно):
- Railway Pro: $20/месяц (включает $20 кредитов)
- Дополнительные ресурсы: ~$5-10/месяц
- Домен (опционально): ~$15/год

## 11. Критерии приемки

### MVP:
- [ ] Odoo развернута на Railway
- [ ] Настроены основные модули
- [ ] Работает производственный учет
- [ ] Настроен партионный учет
- [ ] Работает контроль качества

### Полная версия:
- [ ] Работает интеграция с Меркурий
- [ ] Работает интеграция с Честный ЗНАК
- [ ] Автоматизировано создание задач
- [ ] Настроены все отчеты
- [ ] Проведено обучение пользователей

## 12. Поддержка после запуска

- Исправление критических ошибок: в течение 24 часов
- Консультации по работе: первый месяц включен
- Доработки: по отдельному ТЗ

## 13. Контакты и дополнительная информация

**Примечания:**
- Все пароли и токены хранить в переменных окружения Railway
- Обязательно настроить backup базы данных
- Использовать staging окружение для тестирования
- Документировать все кастомные разработки

---

**Документ подготовлен:** [Дата]
**Версия:** 1.0